Attribute VB_Name = "Module1"
'额定数据和技术要求'
Public PN!  '额定功率'
Public m%     '相数'
Public UN1!  '额定线电压'
Public f%   '额定频率'
Public p%    '极对数'
Public eta!   '额定效率'
Public GLYS!    '额定功率因数cos（phi）'
Public SBZUBS! '失步转矩倍数'
Public QDZJBS! '起动转矩倍数'
Public QDDLBS! '起动电流倍数'
Public DSC% '绕组型式，单双层选择'
Public UN!     '额定相电压'
Public NI! '额定相电流'
Public nN! '额定转速'
Public TN! '额定转矩'

Public EJ$ 'label12显示内容'

''''''''''''''''''''''''''''''
'主要尺寸
Public Lef '电枢计算长度
Public tao1 '极距
Public mFe '硅钢片质量
'定子参数'

Public delta '气隙长度
Public D1  '定子外径
Public Di1  '定子内径
Public L1  '定子铁心长度
Public Q1  '定子槽数
Public KFe '铁心叠压系数
Public h01
Public b01
Public B1
Public r1
Public h12
Public alpha1

'转子参数'

Public Di2 '转子内径
Public L2 '转子铁心长度
Public Q2 '转子槽数
Public h02
Public b02
Public br1
Public br2
Public hr12
Public alpha2

'''''''''''''''''''''''''''''''''''''
'永磁体计算
Public Br20
Public Hc20
Public alphaBr
Public IL
Public t
Public hM
Public bM
Public LM




Function CHQXf(x)
Dim i, j
Dim B, H As Variant
B = Array(0.4, 0.41, 0.42, 0.43, 0.44, 0.45, 0.46, 0.47, 0.48, 0.49, 0.5, 0.51, 0.52, 0.53, 0.54, 0.55, 0.56, 0.57, 0.58, 0.59, 0.6, 0.61, 0.62, 0.63, 0.64, 0.65, 0.66, 0.67, 0.68, 0.69, 0.7, 0.71, 0.72, 0.73, 0.74, 0.75, 0.76, 0.77, 0.76, 0.79, 0.8, 0.81, 0.82, 0.83, 0.84, 0.85, 0.86, 0.87, 0.88, 0.89, 0.9, 0.91, 0.92, 0.93, 0.94, 0.95, 0.96, 0.97, 0.98, 0.99, 1, 1.01, 1.02, 1.03, 1.04, 1.05, 1.06, 1.07, 1.08, 1.09, 1.1, 1.11, 1.12, 1.13, 1.14, 1.15, 1.16, 1.17, 1.18, 1.19, 1.2, 1.21, 1.22, 1.23, 1.24, 1.25, 1.26, 1.27, 1.28, 1.29, 1.3, 1.31, 1.32, 1.33, 1.34, 1.35, 1.36, 1.37, 1.38, 1.39, 1.4, 1.41, 1.42, 1.43, 1.44, 1.45, 1.46, 1.47, 1.48, 1.49, 1.5, 1.51, 1.52, 1.53, 1.54, 1.55, 1.56, 1.57, 1.58, 1.59, 1.6, 1.61, 1.62, 1.63, 1.64, 1.65, 1.66, 1.67, 1.68, 1.69, 1.7, 1.71, 1.72, 1.73, 1.74, 1.75, 1.76, 1.77, 1.78, 1.79, 1.8, 1.81, 1.82, 1.83, 1.84, 1.85, 1.86, 1.87, 1.88, 1.89)
H = Array(1.38, 1.4, 1.42, 1.44, 1.46, 1.48, 1.5, 1.52, 1.54, 1.56, 1.58, 1.6, 1.62, 1.64, 1.66, 1.69, 1.71, 1.74, 1.76, 1.78, 1.81, 1.84, 1.86, 1.89, 1.91, 1.94, 1.97, 2#, 2.03, 2.06, 2.1, 2.13, 2.16, 2.2, 2.24, 2.28, 2.32, 2.36, 2.4, 2.45, 2.5, 2.55, 2.6, 2.65, 2.7, 2.76, 2.81, 2.87, 2.93, 2.99, 3.06, 3.13, 3.19, 3.26, 3.33, 3.41, 3.49, 3.57, 3.65, 3.74, 3.83, 3.92, 4.01, 4.11, 4.22, 4.33, 4.44, 4.56, 4.67, 4.8, 4.93, 5.07, 5.21, 5.36, 5.52, 5.68, 5.84, 6, 6.16, 6.33, 6.52, 6.72, 6.94, 7.16, 7.38, 7.62, 7.86, 8.1, 8.36, 8.62, 8.9, 9.2, 9.5, 9.8, 10.1, 10.5, 10.9, 11.3, 11.7, 12.1, 12.6, 13.1, 13.6, 14.2, 14.8, 15.5, 16.3, 17.1, 18.1, 19.1, 20.1, 21.2, 22.4, 23.7, 25, 26.7, 28.5, 30.4, 32.6, 35.1, 37.8, 40.7, 43.7, 46.8, 50, 53.4, 56.8, 60.4, 64, 67.8, 72, 76.4, 80.8, 85.4, 90.2, 95, 100, 105, 110, 116, 122, 128, 134, 140, 146, 152, 158, 165, 172, 180)
    If x < B(0) Then
        i = 0
        CHQXf = H(i) + (x - B(i)) * (H(i + 1) - H(i)) / (B(i + 1) - B(i))
    ElseIf x > B(149) Then
        i = 149
        CHQXf = H(i) + (x - B(i)) * (H(i + 1) - H(i)) / (B(i + 1) - B(i))
    Else
        For j = 0 To 149
            If x >= B(j) And x <= B(j + 1) Then
                i = j
                CHQXf = H(i) + (x - B(i)) * (H(i + 1) - H(i)) / (B(i + 1) - B(i))
                Exit For
            End If
        Next j
    End If
End Function
Function EBJZXS4Sf(y, x) '4极定子轭部磁路校正系数

Dim i, j
Dim B, H, CCS4, CCR4 As Variant
H = Array(0.001, 0.0321, 0.0561, 0.0802, 0.1042, 0.1282, 0.1522, 0.1761, 0.2001, 0.2242)      'x轴
B = Array(1.24, 1.395, 1.55, 1.71)    'y轴
CCR4 = Array(0.443944198530287, 0.357579627485146, 0.29697291096224, 0.265154384787714, 0.429186463056959, 0.342821892011818, 0.28070000757584, 0.244351129341227, 0.421913657074211, 0.338579421855215, 0.2673665299408, 0.235548003766274, 0.414640851091462, 0.334336951698611, 0.258578556044979, 0.229790365696598, 0.414943884674077, 0.331609649455081, 0.252820917975303, 0.233123735105358, 0.415246918256691, 0.33494301886384, 0.251608783644845, 0.228881264948755, 0.415549951839306, 0.339791556185673, 0.248881481401314, 0.226153962705224, 0.427974328726501, 0.344640093507505, 0.246154179157783, 0.229487332113984, 0.435853201874479, 0.347973462916265, 0.249487548566543, 0.231305533609671, 0.449792746674748, 0.360397839803461, 0.252820917975303, 0.234638903018431)
CCS4 = Array(0.446974534356432, 0.357579627485146, 0.300003246788385, 0.266661976861221, 0.479187004188357, 0.386776913170056, 0.307957878332017, 0.267063496358186, 0.497672052727843, 0.406761977943484, 0.31888223898527, 0.274942369506163, 0.513126765441184, 0.426762194396043, 0.328276280046321, 0.278275738914923, 0.533126981893743, 0.440701739196312, 0.342215824846589, 0.290700115802119, 0.55161203043323, 0.456156451909653, 0.354640201733785, 0.297063821037024, 0.567066743146571, 0.471611164622994, 0.367064578620981, 0.306457862098075, 0.58706695959913, 0.487065877336335, 0.382519291334322, 0.317367071072198, 0.597976168573253, 0.504035757962748, 0.39645883613459, 0.328276280046321, 0.616461217112739, 0.517975302763017, 0.411913548847931, 0.337670321107371)
Dim Z(0 To 9, 0 To 3)    'z二维数组
For i = 0 To 9
For j = 0 To 3
Z(i, j) = CCS4(4 * i + j)
Next j
Next i

   For i = 0 To 9
     If x >= H(i) Then
     Exit For
     End If
   Next i
   For j = 0 To 3
     If y >= B(j) Then
     Exit For
     End If
   Next j
C1 = Z(i, j) + (x - H(i)) / (H(i + 1) - H(i)) * (Z(i + 1, j) - Z(i, j))
C2 = Z(i, j + 1) + (x - H(i)) / (H(i + 1) - H(i)) * (Z(i + 1, j + 1) - Z(i, j + 1))
EBJZXS4Sf = C1 + (y - B(j)) / (B(j + 1) - B(j)) * (C2 - C1)
End Function
Function EBJZXS4Rf(y, x) '4极定子轭部磁路校正系数

Dim i, j
Dim B, H, CCS4, CCR4 As Variant
H = Array(0.001, 0.0321, 0.0561, 0.0802, 0.1042, 0.1282, 0.1522, 0.1761, 0.2001, 0.2242)      'x轴
B = Array(1.24, 1.395, 1.55, 1.71)    'y轴
CCR4 = Array(0.443944198530287, 0.357579627485146, 0.29697291096224, 0.265154384787714, 0.429186463056959, 0.342821892011818, 0.28070000757584, 0.244351129341227, 0.421913657074211, 0.338579421855215, 0.2673665299408, 0.235548003766274, 0.414640851091462, 0.334336951698611, 0.258578556044979, 0.229790365696598, 0.414943884674077, 0.331609649455081, 0.252820917975303, 0.233123735105358, 0.415246918256691, 0.33494301886384, 0.251608783644845, 0.228881264948755, 0.415549951839306, 0.339791556185673, 0.248881481401314, 0.226153962705224, 0.427974328726501, 0.344640093507505, 0.246154179157783, 0.229487332113984, 0.435853201874479, 0.347973462916265, 0.249487548566543, 0.231305533609671, 0.449792746674748, 0.360397839803461, 0.252820917975303, 0.234638903018431)
CCS4 = Array(0.446974534356432, 0.357579627485146, 0.300003246788385, 0.266661976861221, 0.479187004188357, 0.386776913170056, 0.307957878332017, 0.267063496358186, 0.497672052727843, 0.406761977943484, 0.31888223898527, 0.274942369506163, 0.513126765441184, 0.426762194396043, 0.328276280046321, 0.278275738914923, 0.533126981893743, 0.440701739196312, 0.342215824846589, 0.290700115802119, 0.55161203043323, 0.456156451909653, 0.354640201733785, 0.297063821037024, 0.567066743146571, 0.471611164622994, 0.367064578620981, 0.306457862098075, 0.58706695959913, 0.487065877336335, 0.382519291334322, 0.317367071072198, 0.597976168573253, 0.504035757962748, 0.39645883613459, 0.328276280046321, 0.616461217112739, 0.517975302763017, 0.411913548847931, 0.337670321107371)
Dim Z(0 To 9, 0 To 3)    'z二维数组
For i = 0 To 9
For j = 0 To 3
Z(i, j) = CCR4(4 * i + j)
Next j
Next i

   For i = 0 To 9
     If x >= H(i) Then
     Exit For
     End If
   Next i
   For j = 0 To 3
     If y >= B(j) Then
     Exit For
     End If
   Next j

C1 = Z(i, j) + (x - H(i)) / (H(i + 1) - H(i)) * (Z(i + 1, j) - Z(i, j))
C2 = Z(i, j + 1) + (x - H(i)) / (H(i + 1) - H(i)) * (Z(i + 1, j + 1) - Z(i, j + 1))
EBJZXS4Rf = C1 + (y - B(j)) / (B(j + 1) - B(j)) * (C2 - C1)
End Function
Function EBJZXS2Sf(y, x) '轭部磁路校正系数

Dim i, j
Dim B, H, CCS2, CCR2 As Variant
H = Array(0, 0.03, 0.06, 0.09, 0.12, 0.16, 0.19, 0.22, 0.25)                    'x轴
B = Array(1.24, 1.395, 1.55, 1.71)    'y轴
CCR2 = Array(0.456513880675335, 0.36521460282028, 0.310431537827235, 0.271886322558076, 0.503385002373833, 0.412079894052091, 0.320774785730349, 0.278165735180203, 0.550291106872454, 0.463038172898325, 0.339269026062186, 0.288543965883441, 0.587040538401952, 0.50182243730166, 0.365879276022622, 0.305009203808128, 0.617708793176688, 0.536548696890695, 0.390460523575908, 0.323503444139964, 0.646348045544274, 0.559100942036832, 0.425186783164944, 0.348084691693251, 0.67701630031901, 0.587740194404418, 0.45585503793968, 0.374694941653687, 0.705655552686596, 0.610298270017241, 0.488552295121565, 0.397253017266511, 0.718062785796983, 0.634873687103841, 0.527342389991587, 0.427915441574559)
CCS2 = Array(0.456519711142022, 0.36318560041313, 0.306379363479622, 0.265799315336626, 0.416137898866391, 0.343093812208997, 0.263962718330154, 0.233527682222907, 0.385936081426632, 0.327095011619287, 0.229702896076096, 0.203325864783148, 0.369937280836922, 0.315154215843877, 0.201530081043487, 0.183269059379139, 0.362054489875811, 0.303213420068466, 0.181473275639477, 0.165229595448904, 0.35214269650755, 0.291272624293056, 0.173590484678366, 0.159387467828318, 0.352375915175039, 0.291505842960544, 0.173823703345855, 0.157591684088656, 0.356667138656827, 0.291727400694658, 0.180143929234793, 0.159853905163295, 0.367045369360065, 0.30617529714557, 0.182406150309431, 0.166174131052233)
Dim Z(0 To 8, 0 To 3)    'z二维数组
For i = 0 To 8
For j = 0 To 3
Z(i, j) = CCS2(4 * i + j)
Next j
Next i

   For i = 0 To 8
     If x >= H(i) Then
     Exit For
     End If
   Next i
   For j = 0 To 3
     If y >= B(j) Then
     Exit For
     End If
   Next j
C1 = Z(i, j) + (x - H(i)) / (H(i + 1) - H(i)) * (Z(i + 1, j) - Z(i, j))
C2 = Z(i, j + 1) + (x - H(i)) / (H(i + 1) - H(i)) * (Z(i + 1, j + 1) - Z(i, j + 1))
EBJZXS2Sf = C1 + (y - B(j)) / (B(j + 1) - B(j)) * (C2 - C1)
End Function
Function EBJZXS2Rf(y, x) '轭部磁路校正系数

Dim i, j
Dim B, H, CCS2, CCR2 As Variant
H = Array(0, 0.03, 0.06, 0.09, 0.12, 0.16, 0.19, 0.22, 0.25)                    'x轴
B = Array(1.24, 1.395, 1.55, 1.71)    'y轴
CCR2 = Array(0.456513880675335, 0.36521460282028, 0.310431537827235, 0.271886322558076, 0.503385002373833, 0.412079894052091, 0.320774785730349, 0.278165735180203, 0.550291106872454, 0.463038172898325, 0.339269026062186, 0.288543965883441, 0.587040538401952, 0.50182243730166, 0.365879276022622, 0.305009203808128, 0.617708793176688, 0.536548696890695, 0.390460523575908, 0.323503444139964, 0.646348045544274, 0.559100942036832, 0.425186783164944, 0.348084691693251, 0.67701630031901, 0.587740194404418, 0.45585503793968, 0.374694941653687, 0.705655552686596, 0.610298270017241, 0.488552295121565, 0.397253017266511, 0.718062785796983, 0.634873687103841, 0.527342389991587, 0.427915441574559)
CCS2 = Array(0.456519711142022, 0.36318560041313, 0.306379363479622, 0.265799315336626, 0.416137898866391, 0.343093812208997, 0.263962718330154, 0.233527682222907, 0.385936081426632, 0.327095011619287, 0.229702896076096, 0.203325864783148, 0.369937280836922, 0.315154215843877, 0.201530081043487, 0.183269059379139, 0.362054489875811, 0.303213420068466, 0.181473275639477, 0.165229595448904, 0.35214269650755, 0.291272624293056, 0.173590484678366, 0.159387467828318, 0.352375915175039, 0.291505842960544, 0.173823703345855, 0.157591684088656, 0.356667138656827, 0.291727400694658, 0.180143929234793, 0.159853905163295, 0.367045369360065, 0.30617529714557, 0.182406150309431, 0.166174131052233)
Dim Z(0 To 8, 0 To 3)    'z二维数组
For i = 0 To 8
For j = 0 To 3
Z(i, j) = CCR2(4 * i + j)
Next j
Next i

   For i = 0 To 8
     If x >= H(i) Then
     Exit For
     End If
   Next i
   For j = 0 To 3
     If y >= B(j) Then
     Exit For
     End If
   Next j
C1 = Z(i, j) + (x - H(i)) / (H(i + 1) - H(i)) * (Z(i + 1, j) - Z(i, j))
C2 = Z(i, j + 1) + (x - H(i)) / (H(i + 1) - H(i)) * (Z(i + 1, j + 1) - Z(i, j + 1))
EBJZXS2Rf = C1 + (y - B(j)) / (B(j + 1) - B(j)) * (C2 - C1)
End Function
Function EBJZXS6Sf(y, x) '定子轭部磁路校正系数

Dim i, j
Dim B, H, CCS6, CCR6 As Variant
H = Array(0.001, 0.024, 0.056, 0.088, 0.12, 0.152, 0.184, 0.216, 0.248)     'x轴
B = Array(1.24, 1.395, 1.55, 1.71)    'y轴
CCR6 = Array(0.451280777826593, 0.361037993543581, 0.302859544230292, 0.26876277435006, 0.453674237359363, 0.363418081794044, 0.307258696108957, 0.269150541536933, 0.4542090886516, 0.371975702469867, 0.303782162709404, 0.271691085175068, 0.46276670932742, 0.378527630799794, 0.312339783385227, 0.270220244121411, 0.47333002234914, 0.385079559129721, 0.312874634677466, 0.27075509541365, 0.491916104754446, 0.395642872151439, 0.32544364004508, 0.285329793127161, 0.50649080246795, 0.406206185173158, 0.336006953066799, 0.29589310614888, 0.53109396191094, 0.416769498194877, 0.346570266088518, 0.316471509617772, 0.561714198391626, 0.43535558060018, 0.371173425531509, 0.341088040343069)
CCS6 = Array(0.451280777826593, 0.361037993543581, 0.302872915512598, 0.270768466695956, 0.453674237359363, 0.363418081794044, 0.309277759737159, 0.269163912819239, 0.454209088651602, 0.371975702469867, 0.307793547401196, 0.269685392829172, 0.462766709327424, 0.378527630799794, 0.312339783385227, 0.270220244121411, 0.473330022349143, 0.385079559129721, 0.312874634677466, 0.272760787759546, 0.491916104754446, 0.395642872151439, 0.319426563007392, 0.271289946705889, 0.506490802467957, 0.406206185173158, 0.319961414299631, 0.281853259727608, 0.531093961910947, 0.416769498194877, 0.33052472732135, 0.296427957441119, 0.561714198391626, 0.43535558060018, 0.343093732688965, 0.325042501575901)


Dim Z(0 To 8, 0 To 3)    'z二维数组
For i = 0 To 8
For j = 0 To 3
Z(i, j) = CCS6(4 * i + j)
Next j
Next i

   For i = 0 To 8
     If x >= H(i) Then
     Exit For
     End If
   Next i
   For j = 0 To 3
     If y >= B(j) Then
     Exit For
     End If
   Next j
C1 = Z(i, j) + (x - H(i)) / (H(i + 1) - H(i)) * (Z(i + 1, j) - Z(i, j))
C2 = Z(i, j + 1) + (x - H(i)) / (H(i + 1) - H(i)) * (Z(i + 1, j + 1) - Z(i, j + 1))
EBJZXS6Sf = C1 + (y - B(j)) / (B(j + 1) - B(j)) * (C2 - C1)
End Function
Function EBJZXS6Rf(y, x) '转子轭部磁路校正系数

Dim i, j
Dim B, H, CCS6, CCR6 As Variant
H = Array(0.001, 0.024, 0.056, 0.088, 0.12, 0.152, 0.184, 0.216, 0.248)     'x轴
B = Array(1.24, 1.395, 1.55, 1.71)    'y轴
CCR6 = Array(0.451280777826593, 0.361037993543581, 0.302859544230292, 0.26876277435006, 0.453674237359363, 0.363418081794044, 0.307258696108957, 0.269150541536933, 0.4542090886516, 0.371975702469867, 0.303782162709404, 0.271691085175068, 0.46276670932742, 0.378527630799794, 0.312339783385227, 0.270220244121411, 0.47333002234914, 0.385079559129721, 0.312874634677466, 0.27075509541365, 0.491916104754446, 0.395642872151439, 0.32544364004508, 0.285329793127161, 0.50649080246795, 0.406206185173158, 0.336006953066799, 0.29589310614888, 0.53109396191094, 0.416769498194877, 0.346570266088518, 0.316471509617772, 0.561714198391626, 0.43535558060018, 0.371173425531509, 0.341088040343069)
CCS6 = Array(0.451280777826593, 0.361037993543581, 0.302872915512598, 0.270768466695956, 0.453674237359363, 0.363418081794044, 0.309277759737159, 0.269163912819239, 0.454209088651602, 0.371975702469867, 0.307793547401196, 0.269685392829172, 0.462766709327424, 0.378527630799794, 0.312339783385227, 0.270220244121411, 0.473330022349143, 0.385079559129721, 0.312874634677466, 0.272760787759546, 0.491916104754446, 0.395642872151439, 0.319426563007392, 0.271289946705889, 0.506490802467957, 0.406206185173158, 0.319961414299631, 0.281853259727608, 0.531093961910947, 0.416769498194877, 0.33052472732135, 0.296427957441119, 0.561714198391626, 0.43535558060018, 0.343093732688965, 0.325042501575901)


Dim Z(0 To 8, 0 To 3)    'z二维数组
For i = 0 To 8
For j = 0 To 3
Z(i, j) = CCR6(4 * i + j)
Next j
Next i

   For i = 0 To 8
     If x >= H(i) Then
     Exit For
     End If
   Next i
   For j = 0 To 3
     If y >= B(j) Then
     Exit For
     End If
   Next j
C1 = Z(i, j) + (x - H(i)) / (H(i + 1) - H(i)) * (Z(i + 1, j) - Z(i, j))
C2 = Z(i, j + 1) + (x - H(i)) / (H(i + 1) - H(i)) * (Z(i + 1, j + 1) - Z(i, j + 1))
EBJZXS6Rf = C1 + (y - B(j)) / (B(j + 1) - B(j)) * (C2 - C1)
End Function
Function SHQXf(x)
Dim i, j
Dim B, H As Variant
B = Array(0.5, 0.51, 0.52, 0.53, 0.54, 0.55, 0.56, 0.57, 0.58, 0.59, 0.6, 0.61, 0.62, 0.63, 0.64, 0.65, 0.66, 0.67, 0.68, 0.69, 0.7, 0.71, 0.72, 0.73, 0.74, 0.75, 0.76, 0.77, 0.78, 0.79, 0.8, 0.81, 0.82, 0.83, 0.84, 0.85, 0.86, 0.87, 0.88, 0.89, 0.9, 0.91, 0.92, 0.93, 0.94, 0.95, 0.96, 0.97, 0.98, 0.99, 1, 1.01, 1.02, 1.03, 1.04, 1.05, 1.06, 1.07, 1.08, 1.09, 1.1, 1.11, 1.12, 1.13, 1.14, 1.15, 1.16, 1.17, 1.18, 1.19, 1.2, 1.21, 1.22, 1.23, 1.24, 1.25, 1.26, 1.27, 1.28, 1.29, 1.3, 1.31, 1.32, 1.33, 1.34, 1.35, 1.36, 1.37, 1.38, 1.39, 1.4, 1.41, 1.42, 1.43, 1.44, 1.45, 1.46, 1.47, 1.48, 1.49, 1.5, 1.51, 1.52, 1.53, 1.54, 1.55, 1.56, 1.57, 1.58, 1.59, 1.6, 1.61, 1.62, 1.63, 1.64, 1.65, 1.66, 1.67, 1.68, 1.69, 1.7, 1.71, 1.72, 1.73, 1.74, 1.75, 1.76, 1.77, 1.78, 1.79, 1.8, 1.81, 1.82, 1.83, 1.84, 1.85, 1.86, 1.87, 1.88, 1.89, 1.9, 1.91, 1.92, 1.93, 1.94, 1.95, 1.96, 1.97, 1.98, 1.99)
H = Array(5.15, 5.35, 5.55, 5.76, 5.98, 6.17, 6.38, 6.57, 6.78, 7, 7.22, 7.42, 7.62, 7.84, 8.05, 8.26, 8.48, 8.7, 8.9, 9.12, 9.35, 9.55, 9.76, 9.98, 10.2, 10.4, 10.6, 10.8, 11, 11.3, 11.5, 11.7, 12, 12.2, 12.4, 12.6, 12.8, 13.1, 13.3, 13.5, 13.8, 14, 14.3, 14.5, 14.8, 14.1, 15.3, 15.6, 15.9, 16.2, 16.5, 16.8, 17.1, 17.4, 17.8, 18.1, 18.4, 18.8, 19.2, 19.6, 20, 20.4, 20.8, 21.2, 21.7, 22.1, 22.6, 23, 23.5, 24, 24.5, 25, 25.4, 26, 26.4, 27, 27.5, 28, 28.5, 29, 29.5, 30, 30.5, 31, 31.6, 32.1, 32.6, 33.1, 33.6, 34.2, 34.7, 35.2, 35.7, 36.2, 36.7, 37.2, 37.8, 38.3, 38.8, 39.4, 39.8, 40.4, 40.9, 41.4, 41.9, 42.4, 42.9, 43.5, 44, 44.5, 45, 45.6, 46.1, 46.6, 47.1, 47.7, 48.2, 48.7, 49.2, 49.7, 50.2, 50.7, 51.3, 51.8, 52.3, 52.9, 53.5, 54.1, 54.7, 55.4, 56.1, 56.8, 57.4, 58.1, 58.9, 59.6, 60.3, 61, 61.8, 62.6, 63.4, 64.1, 64.8, 65.6, 66.4, 67.2, 67.9, 68.7, 69.4, 70.3)

    If x < B(0) Then
        i = 0
        SHQXf = H(i) + (x - B(i)) * (H(i + 1) - H(i)) / (B(i + 1) - B(i))
    ElseIf x > B(149) Then
        i = 149
        SHQXf = H(i) + (x - B(i)) * (H(i + 1) - H(i)) / (B(i + 1) - B(i))
    Else
        For j = 0 To 149
            If x >= B(j) And x <= B(j + 1) Then
                i = j
                SHQXf = H(i) + (x - B(i)) * (H(i + 1) - H(i)) / (B(i + 1) - B(i))
                Exit For
            End If
        Next j
    End If
End Function
